<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>FaceLab — Expressions · Landmarks · Age · Identify</title>
  <link rel="stylesheet" href="styles.css">
  <!-- face-api.js from CDN -->
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36'><circle cx='18' cy='18' r='18' fill='%232A9D8F'/><path d='M18 8c5 0 9 4 9 9s-4 9-9 9-9-4-9-9 4-9 9-9z' fill='%23fff' opacity='0.12'/></svg>" alt="logo">
      <div>
        <h1>FaceLab</h1>
        <small>Expressions · Landmarks · Age/Gender · Recognition</small>
      </div>
    </div>
    <nav>
      <button id="btnLoadModels" class="btn">Load Models</button>
      <button id="btnStart" class="btn primary">Start Camera</button>
      <button id="btnStop" class="btn">Stop Camera</button>
    </nav>
  </header>

  <main class="container">
    <section class="left">
      <div class="video-wrap">
        <video id="video" autoplay muted playsinline></video>
        <canvas id="overlay"></canvas>
      </div>

      <div class="controls">
        <div class="control-group">
          <label>Detection model</label>
          <select id="detectionModel">
            <option value="tiny">Tiny Face Detector (fast)</option>
            <option value="ssd">SSD Mobilenet (acc)</option>
          </select>
          <label>Input size</label>
          <input id="inputSize" type="number" min="128" max="1024" value="320">
          <label>Score threshold</label>
          <input id="scoreThreshold" type="number" step="0.01" min="0.0" max="1.0" value="0.5">
        </div>

        <div class="status">
          <div>Models: <span id="modelsStatus">not loaded</span></div>
          <div>Recognition database: <span id="dbCount">0</span> labels</div>
        </div>
      </div>
    </section>

    <aside class="right">
      <h2>Live Readouts</h2>
      <div class="readouts">
        <div><strong>Faces:</strong> <span id="faceCount">0</span></div>
        <div><strong>Expressions:</strong> <span id="expressions">—</span></div>
        <div><strong>Approx Age:</strong> <span id="age">—</span></div>
        <div><strong>Gender:</strong> <span id="gender">—</span></div>
        <div><strong>Identified:</strong> <ul id="identifiedList"></ul></div>
      </div>

      <h3>Register / Identify</h3>
      <div class="reg">
        <input id="labelName" placeholder="Name to register (e.g. Alice)">
        <input id="labeledImages" type="file" accept="image/*" multiple>
        <button id="btnRegister" class="btn">Register</button>
        <button id="btnClearDB" class="btn danger">Clear DB</button>
        <div class="db-tools">
          <button id="btnExport" class="btn">Export DB</button>
          <button id="btnImport" class="btn">Import DB</button>
          <input id="importFile" type="file" accept="application/json" style="display:none;">
        </div>
      </div>

      <h3>Tips & Troubleshooting</h3>
      <ul class="tips">
        <li>Run on <strong>http://localhost</strong> or HTTPS — camera & models require a secure origin.</li>
        <li>If camera works on Mac but not Windows: check camera permissions & try a different browser (Chrome/Edge).</li>
        <li>For best speed, use Tiny detector; for more accuracy, use SSD.</li>
      </ul>

      <footer class="footer">
        <small>Built with face-api.js · Works on Windows & macOS browsers</small>
      </footer>
    </aside>
  </main>
</body>
</html>